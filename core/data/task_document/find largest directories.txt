name: Find files/directories that take up the most space
description: Identify the largest files and folders within a specified scope and report their sizes and paths.

goal/outcome:
  - Confirmed scope (root path) and any exclusions for size analysis.
  - Completed size scan using safe, efficient tools; captured top size-heavy files/directories with human-readable sizes.
  - Delivered ordered list of largest items with paths, sizes, and brief notes on what they are (if inferable).
  - Offered next actions (clean up, archive, inspect) if desired.

inputs_params:
  - Required: Directory path to analyze or confirmation of default working directory.
  - Optional: Depth limit, number of top results to return, exclusions (e.g., .git, node_modules, venvs, caches), file vs directory preference, follow-symlinks preference.

context:
    reasoning:
      - Clarify scope and exclusions to avoid scanning unnecessary or sensitive areas.
      - Use efficient size tools (du, Python os.walk) with pruning for excluded directories to maintain performance.
      - Present results in human-readable units with clear ordering for quick action.
    deadline: {time remaining} left until deadline {deadline in absolute time format}
    definition_of_done(check during final validation step):
      - Scope/exclusions confirmed; scan executed within that boundary.
      - Top size-heavy items listed with human-readable sizes and paths, ordered by size.
      - Any assumptions (symlink handling, exclusions) stated.
    avoid:
      - Running unbounded scans across the entire filesystem without approval.
      - Following symlinks unintentionally or including excluded/system directories.
      - Reporting raw blocks without human-readable context.

steps:
    name: Confirm scope and exclusions
    description: Agree on the directory to analyze and what to skip before scanning.
    action_instruction: Ask for or confirm the root directory, number of top results, depth limit, and exclusions (e.g., .git, node_modules, venvs, caches). Clarify whether to follow symlinks. Restate the agreed scope and parameters.
    validation_instruction: Ensure the target directory exists and parameters are coherent (e.g., positive depth/top count). If the path seems unsafe or too broad, propose a safer subset.

    name: Plan size scan
    description: Choose the tools and commands that best fit scope and performance needs.
    action_instruction: Select appropriate actions (du with flags, Python disk usage script) with pruning for exclusions and human-readable output. Prepare commands to limit depth/top results if requested.
    validation_instruction: Confirm the planned commands respect exclusions and avoid following symlinks unless approved. Adjust for performance if the directory is large.

    name: Execute size analysis
    description: Run the scan and collect size data.
    action_instruction: Execute the planned commands, capturing sizes in human-readable units alongside full paths. If using Python, handle permission errors gracefully and skip excluded paths. Record the top results per the requested count.
    validation_instruction: Verify collected entries are within the approved scope and exclusions were honored. Ensure ordering is correct by size and units are readable.

    name: Validate overall results
    description: Confirm findings meet the definition of done.
    action_instruction: Check that scope/exclusions were applied, sizes are human-readable, ordering is correct, and assumptions (e.g., symlink handling) are noted. Prepare the ranked list for delivery.

    name: Report findings and close
    description: Share results, propose next steps, and close the task.
    action_instruction: Present the top largest files/directories with sizes and paths, mention exclusions/assumptions, and offer follow-up actions (e.g., delete, compress, inspect). Then mark the task completed and clean up any temporary files if created.
