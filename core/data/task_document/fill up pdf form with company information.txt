name: Fill up PDF form with company information
description: The agent is given a PDF form from the user and the agent needs to fill up the PDF form with accurate company information if they eixst, otherwise the agent asks the user for information. Once the form is filled, the agent sends the updated form back to user for confirmation.

goal/outcome:
  - A completed, fillable PDF form is populated with accurate {company} information and saved as {file name}.
  - All required fields are filled with validated values mapped to the correct PDF fields.
  - The final PDF preserves original formatting, field integrity, and opens without errors.
  - A delivery message summarizing filled sections and any assumptions is sent to the user with the completed file attached.
  - An audit note (who/what/when) is recorded for traceability of the fill operation.

inputs_params:
    - The original PDF form file (fillable) to be completed.
    - Canonical {company} information source (e.g., memory, database, files, or user-provided text) for example: legal name, registered address, phone/email, tax ID, registration number, website (if any), authorized signatory (if applicable) and more.
    - Field mapping if field names in the PDF are non-obvious (e.g., "Reg No." → company_registration_number). If not provided, the agent will infer and document a proposed mapping.

context:
  reasoning:
    - Enumerate all fillable fields in the PDF and identify if the agent contain enough information to fill them up.
	- Perform UI grounding to identify the fields' coordinate and length.
	- If there are missing context/information, ask the user. 
    - Create a temporary txt file to store the deterministic field-to-attribute mapping table with truncation strategy for field length limits.
	- Validate the value and make sure they are correct, confirm with the user only when necessary.
	- Fill in the form while referring to the temporary txt file 
    - Validate the filled PDF visually and re-run with corrections if any discrepancies are detected.
    - Produce delivery artifacts (final PDF) and wait for user confirmation.
  deadline: {time_left} left until deadline {deadline}
  definition_of_done(check during final validation step):
    - Completeness: 100% of required fields filled; optional fields filled when data is available and relevant.
    - Correctness: Field values exactly match the canonical {company} source (or documented transformation rules).
	- Receive user confirmation of the filled form is valid or did not receive any complain after send the form to the user for a long period of time.
    - Format integrity: No text overflow that obscures labels; no broken forms; file opens without warnings.
    - Naming: Output file named as {file name}; PDF metadata (Title/Author/Subject) updated where supported.
  avoid:
    - Leaving required fields blank or inserting guesswork without marking and notifying.
    - Using placeholders or "N/A" unless explicitly requested.
    - Modifying the document’s non-form content or layout.
	- Create a new form instead of updating the original form.
    - Truncating key identifiers (e.g., tax ID) without an explicit truncation strategy and user notice.
	- Filling up the form with incorrect formatting visually.
    - Delivering without a validation pass and summary.

steps:
  name: Download form
  description: Download the provided PDF into agent workspace.
  action_instruction: use 'download attachment' action to download the PDF file (using the file's url;download into the inside of agent workspace directory).
  validation_instruction: Confirm the file exists in the agent workspace using search file name

  name: Read form
  description: Enumerate, classify, and export all fillable fields from the provided PDF; identify the fields and capture UI grounding (coordinate, max length, type).
  action_instruction: Use 'create txt file' to store field-to-attribute mapping. Use 'read pdf file' to parse the data with UI grounding. Perform 'read pdf file' multiple times with pagination when the form exceed 3 pages and save the field data into the created txt file.  
  validation_instruction: Confirm the pdf file is valid and not empty. Confirm the pdf file is correct; 

  name: Map form fields with data
  description: Create a deterministic mapping between PDF fields and company attributes with respect to the field length in the temporary txt file.
  action_instruction: For each field in the txt file, input a mapping to an attribute, by referring to memory, database, or other data source. You cannot put any placeholder or self inferred data unless being explicitly told to. use the '' action to update the txt file. Where ambiguity exists, ask you.
  validation_instruction: Use 'read txt file' to ensure every required field has a mapped attribute; Ensure all the attributes are valid factually. 

  name: Populate the PDF fields
  description: Fill the PDF with mapped values respecting field format, visual, types and length constraints.
  action_instruction: Open the PDF in write mode, Refer to the temporary txt file for the attribute. Fill in the fields with accurate field position according to the UI grounding. For text fields: compute final value via transform pipeline; enforce max_length strategy. For checkboxes/radios: set values based on boolean or enumerated attributes. For dropdowns: select the closest allowed value or halt if no acceptable match. For image/logo fields: insert provided logo if available and allowed. Save an intermediate file as "{file name}.draft.pdf".
  validation_instruction: Re-open the draft; Switch to GUI mode to open the the PDF file and verify all required fields render visibly; no clipped labels; long addresses wrap per rule; identifiers (tax_id, registration_number) are exact; dropdowns reflect permitted values; confirm the document still reports as fillable and uncorrupted.

  name: Verify format, consistency and quality
  description: Cross-check the filled values against canonical data.
  action_instruction: Check for errors exist (missing/overflow/mismatch), fix mappings/values and re-run previous steps until clean. Save final as {file name}. Ensure 100% required fields filled correctly according to data source; 0 mismatches; no unintended truncation; correct format visually; PDF opens without warnings;

  name: Deliver completed PDF to user
  description: Send the final PDF to the user; capture receipt and validation confirmation from user and next steps if any.
  action_instruction: Use 'send message with attachment' to send user message summarizing what was filled, notable decisions (e.g., truncation), and any fields requiring confirmation.

  name: Close task session and cleanup
  description: Finalize records, clean temporary txt file, and mark the task state.
  action_instruction: Update the proactive goal journal/audit log with prediction of tasks help to improve the user/team according to their current status (only if there is a need, otherwise skip this step). Delete temporary files (e.g., the field-attribute map txt file). Mark task completed; if blocked/cancelled, record reason and mark appropriately.
